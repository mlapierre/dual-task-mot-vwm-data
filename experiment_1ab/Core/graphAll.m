%% Import data from spreadsheet
% Script for importing data from the following spreadsheet:
%
%    Workbook: D:\My Documents\My
%    Dropbox\PhD\Matlab\MOT_VWM_FF_0.0.2\combined.csv Worksheet: combined
%
% To extend the code to different selected data or a different spreadsheet,
% generate a function instead of a script.

% Auto-generated by MATLAB on 2012/02/25 15:05:09

%% Import the data
%[~, ~, raw] = csvread('combined.csv','combined');
raw = csvread('combined.csv',1,0);
%raw = raw(2:end,:);

%% Create output variable
%data = cell2mat(raw);
data = raw;
%% Allocate imported array to column variable names
OnlyMean = data(:,1);
OnlySTM = data(:,2);
MOTResFirstMean = data(:,3);
MOTResFirstSTM = data(:,4);
VWMResFirstMean = data(:,5);
VWMResFirstSTM = data(:,6);

%% Display graph
figure; 
x = 1:6;
y = [OnlyMean MOTResFirstMean VWMResFirstMean];
bar(x,y);
    err = [OnlySTM MOTResFirstSTM VWMResFirstSTM];
    hold all;
    
h = errorbar(x-0.225,y(:,1), err(:,1));
set(h,'linestyle','none');
set(h, 'Color', 'b');
h = errorbar(x,y(:,2), err(:,2));
set(h,'linestyle','none');
set(h, 'Color', 'g');
h = errorbar(x+0.225,y(:,3), err(:,3));
set(h,'linestyle','none');
set(h, 'Color', 'r');
    
    set(gca,'YLim', yLim);
    %title('VWM Mean percent correct');
    %title('Mean number tracked as per Zhang et al.');
    %title('Mean number tracked as per Fougnie & Marois.');
    %title('Mean Beta');
    title(currTitle);
    if currTask == 1
        legend({'MOT-Only','MOT-1st','VWM-1st'}, 'Location', currLegLoc);
    else
        legend({'VWM-Only','MOT-1st','VWM-1st'}, 'Location', currLegLoc);
    end
    set(gca,'XTickLabel',pInitials);
    %set(gca,'XTickLabel',{'BS','RM'});
    
%% Clear temporary variables
clearvars data raw;
